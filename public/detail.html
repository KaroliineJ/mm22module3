<script>
  function toggleAccordion(id) {
    const el = document.getElementById(id);
    el.classList.toggle("hidden");
  }

  document.addEventListener("DOMContentLoaded", async () => {
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");
    if (!id) return;

    try {
      const res = await fetch(`http://localhost:4000/api/products/${id}`);
      const product = await res.json();

      document.getElementById("product-title").textContent = product.name;
      document.getElementById("product-price").textContent = product.price + " €";
      document.getElementById("product-description").textContent = product.description;
      document.getElementById("product-image").src = product.images?.[0] || "assets/default.jpg";

      // Thumbnailide uuendus kui olemas
      if (product.images?.[1]) document.getElementById("thumb-1").src = product.images[1];
      if (product.images?.[2]) document.getElementById("thumb-2").src = product.images[2];

      // Suuruste peitmine (vajadusel)
      if (!product.sizes || product.sizes.length === 0) {
        document.getElementById("size-section").style.display = "none";
      } else {
        const select = document.getElementById("size");
        product.sizes.forEach(s => {
          const option = document.createElement("option");
          option.value = s;
          option.textContent = s;
          select.appendChild(option);
        });
      }

    } catch (err) {
      console.error("Toote andmete laadimine ebaõnnestus:", err);
    }

    // Pildivahetus thumb klikiga
    document.getElementById("thumb-1").onclick = () => {
      document.getElementById("product-image").src = document.getElementById("thumb-1").src;
    };
    document.getElementById("thumb-2").onclick = () => {
      document.getElementById("product-image").src = document.getElementById("thumb-2").src;
    };
  });
</script>
